<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            touch-action: manipulation;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 15px;
        }

        header {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 15px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        nav ul {
            display: flex;
            list-style: none;
            flex-wrap: wrap;
            gap: 10px;
        }

        nav ul li a {
            color: white;
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            font-size: 14px;
            display: block;
        }

        main {
            min-height: calc(100vh - 120px);
            padding: 20px 0;
        }

        .card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
        }

        .btn {
            display: inline-block;
            padding: 14px 24px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            text-decoration: none;
            margin: 5px;
            width: calc(100% - 10px);
            min-height: 50px;
            touch-action: manipulation;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-success {
            background: #27ae60;
        }

        .btn-danger {
            background: #e74c3c;
        }

        .btn-warning {
            background: #f39c12;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
            min-height: auto;
            width: auto;
        }

        .hidden {
            display: none !important;
        }

        .question {
            margin-bottom: 20px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
        }

        .options {
            margin-top: 15px;
        }

        .option {
            margin-bottom: 12px;
            padding: 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            background: white;
            min-height: 60px;
            display: flex;
            align-items: center;
            font-size: 16px;
        }

        .option:active {
            background: #f0f0f0;
        }

        .option.selected {
            background: #e1f0fa;
            border-color: #3498db;
        }

        .timer {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
            padding: 12px;
            background: #ecf0f1;
            border-radius: 8px;
        }

        .progress-bar {
            height: 12px;
            background: #ecf0f1;
            border-radius: 6px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2980b9);
            width: 0%;
            transition: width 0.3s;
        }

        .results {
            text-align: center;
        }

        .score {
            font-size: 24px;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .admin-panel {
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            font-size: 14px;
        }

        th, td {
            padding: 12px 8px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        th {
            background: #34495e;
            color: white;
            font-weight: bold;
        }

        .warning-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .warning-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 90%;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .warning-content h3 {
            color: #e74c3c;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .login-form {
            max-width: 100%;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #2c3e50;
            font-size: 16px;
        }

        input[type="text"],
        input[type="password"],
        textarea {
            width: 100%;
            padding: 14px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-size: 16px;
            min-height: 50px;
        }

        input[type="text"]:focus,
        input[type="password"]:focus,
        textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .navigation {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .navigation .btn {
            width: 100%;
        }

        .admin-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .logo {
                margin-bottom: 10px;
                font-size: 18px;
            }
            
            nav ul {
                justify-content: center;
                width: 100%;
            }
            
            nav ul li {
                margin: 2px;
            }
            
            nav ul li a {
                padding: 6px 10px;
                font-size: 12px;
            }
            
            .card {
                padding: 15px;
                margin-bottom: 15px;
            }
            
            .btn {
                padding: 16px 20px;
                font-size: 16px;
                margin: 4px 0;
            }
            
            .option {
                padding: 14px;
                font-size: 15px;
                min-height: 55px;
            }
            
            table {
                font-size: 12px;
            }
            
            th, td {
                padding: 8px 6px;
            }

            .admin-controls {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .logo {
                font-size: 16px;
            }
            
            nav ul li a {
                font-size: 11px;
                padding: 5px 8px;
            }
            
            .timer {
                font-size: 16px;
                padding: 10px;
            }
            
            .score {
                font-size: 20px;
            }
            
            table {
                font-size: 11px;
            }
        }

        /* –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –∫–∞—Å–∞–Ω–∏–π */
        @media (hover: none) and (pointer: coarse) {
            .option {
                min-height: 65px;
                padding: 18px;
            }
            
            .btn {
                min-height: 55px;
                padding: 18px 20px;
            }
            
            input[type="text"],
            input[type="password"],
            textarea {
                min-height: 55px;
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
                <nav>
                    <ul>
                        <li><a href="#" id="nav-home">üè† –ì–ª–∞–≤–Ω–∞—è</a></li>
                        <li><a href="#" id="nav-admin" class="hidden">‚öôÔ∏è –ê–¥–º–∏–Ω</a></li>
                        <li><a href="#" id="nav-login">üîê –í—Ö–æ–¥</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
            <div id="home-page" class="card">
                <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üëã</h1>
                <p>–°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞–Ω–∏–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</p>
                
                <div class="alert alert-info">
                    <p><strong>üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</strong></p>
                    <ul>
                        <li>‚úÖ 12 –≤–æ–ø—Ä–æ—Å–æ–≤</li>
                        <li>‚è±Ô∏è 20 –º–∏–Ω—É—Ç</li>
                        <li>üö´ –ù–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –≤–∫–ª–∞–¥–∫–∏</li>
                        <li>üèÅ –ù–∞–∂–º–∏—Ç–µ "–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç"</li>
                    </ul>
                </div>
                
                <div class="form-group">
                    <label for="user-id">üë§ –í–∞—à –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä:</label>
                    <input type="text" id="user-id" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ò–≤–∞–Ω–æ–≤ –ò.–ò.">
                </div>
                
                <button id="start-test" class="btn btn-success">üéØ –ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç</button>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–µ—Å—Ç–∞ -->
            <div id="test-page" class="card hidden">
                <div class="timer" id="timer">‚è±Ô∏è –û—Å—Ç–∞–ª–æ—Å—å: 20:00</div>
                <div class="progress-bar">
                    <div class="progress" id="progress"></div>
                </div>
                
                <div id="question-container">
                    <!-- –í–æ–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                
                <div class="navigation">
                    <button id="prev-question" class="btn">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
                    <button id="next-question" class="btn">–í–ø–µ—Ä–µ–¥ ‚û°Ô∏è</button>
                    <button id="finish-test" class="btn btn-danger">üèÅ –ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
                </div>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
            <div id="results-page" class="card hidden">
                <div class="results">
                    <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
                    <div class="score" id="score-result"></div>
                    <div id="time-result"></div>
                    <div id="violations-result"></div>
                    <button id="back-to-home" class="btn">üîÑ –ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
                </div>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
            <div id="login-page" class="card hidden">
                <h2>üîê –í—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
                <div class="login-form">
                    <div class="form-group">
                        <label for="admin-login">üë§ –õ–æ–≥–∏–Ω:</label>
                        <input type="text" id="admin-login" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω">
                    </div>
                    <div class="form-group">
                        <label for="admin-password">üîí –ü–∞—Ä–æ–ª—å:</label>
                        <input type="password" id="admin-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                    </div>
                    <button id="admin-login-btn" class="btn">üö™ –í–æ–π—Ç–∏</button>
                </div>
            </div>

            <!-- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
            <div id="admin-page" class="card hidden">
                <h2>‚öôÔ∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å</h2>
                
                <div class="admin-controls">
                    <button id="refresh-results" class="btn btn-small">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                    <button id="export-results" class="btn btn-small">üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV</button>
                    <button id="clear-results" class="btn btn-small btn-danger">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                </div>

                <div class="admin-panel">
                    <h3>üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤</h3>
                    <div id="results-count" class="alert alert-info">
                        –í—Å–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: <span id="total-results">0</span>
                    </div>
                    <table id="results-table">
                        <thead>
                            <tr>
                                <th>üë§ ID</th>
                                <th>üìÖ –î–∞—Ç–∞</th>
                                <th>‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ</th>
                                <th>üìù –í—Å–µ–≥–æ</th>
                                <th>‚è±Ô∏è –í—Ä–µ–º—è</th>
                                <th>üö´ –ù–∞—Ä—É—à.</th>
                                <th>‚úçÔ∏è –û—Ç–≤–µ—Ç –Ω–∞ 12 –≤–æ–ø—Ä–æ—Å</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </tbody>
                    </table>
                    
                    <h3>üìã –ñ—É—Ä–Ω–∞–ª –Ω–∞—Ä—É—à–µ–Ω–∏–π</h3>
                    <table id="violations-table">
                        <thead>
                            <tr>
                                <th>üë§ ID</th>
                                <th>üìÖ –î–∞—Ç–∞</th>
                                <th>‚ö†Ô∏è –¢–∏–ø</th>
                                <th>‚ÑπÔ∏è –ò–Ω—Ñ–æ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </tbody>
                    </table>
                    
                    <button id="admin-logout" class="btn btn-danger">üö™ –í—ã–π—Ç–∏</button>
                </div>
            </div>
        </div>
    </main>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è -->
    <div id="warning-modal" class="warning-modal hidden">
        <div class="warning-content">
            <h3>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!</h3>
            <p>–í—ã –ø–æ–∫–∏–Ω—É–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–µ—Å—Ç–∞. –ù–∞—Ä—É—à–µ–Ω–∏–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ.</p>
            <p>–ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏ —Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</p>
            <button id="warning-ok" class="btn btn-warning">üëå –ü–æ–Ω—è—Ç–Ω–æ</button>
        </div>
    </div>

    <script>
        // –í—Å–µ –≤–æ–ø—Ä–æ—Å—ã —Ç–µ—Å—Ç–∞
        const testData = {
            title: "–¢–µ—Å—Ç –ø–æ —Ñ–∏—Ç–Ω–µ—Å—É –∏ –∞–Ω–∞—Ç–æ–º–∏–∏",
            timeLimit: 20 * 60, // 20 –º–∏–Ω—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
            questions: [
                {
                    id: 1,
                    text: "1. –í –∫–∞–∫–æ–º –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º—ã—à—Ü—ã-—Ä–∞–∑–≥–∏–±–∞—Ç–µ–ª–∏?",
                    options: [
                        { id: 1, text: "a) –°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è –¥–ª—è –ø—Ä–µ—Å—Å–∞" },
                        { id: 2, text: "b) –û–±—Ä–∞—Ç–Ω—ã–µ —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è" },
                        { id: 3, text: "c) –°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞", correct: true },
                        { id: 4, text: "d) –ü–ª–∞–Ω–∫–∞" }
                    ]
                },
                {
                    id: 2,
                    text: "2. –ö–∞–∫–∞—è –º—ã—à—Ü–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∞ –Ω–∞ –∑–∞–¥–Ω–µ–π —Å—Ç–æ—Ä–æ–Ω–µ –±–µ–¥—Ä–∞?",
                    options: [
                        { id: 1, text: "a) –ò–∫—Ä–æ–Ω–æ–∂–Ω–∞—è" },
                        { id: 2, text: "b) –ö–≤–∞–¥—Ä–∏—Ü–µ–ø—Å" },
                        { id: 3, text: "c) –ü–æ–¥–∫–æ–ª–µ–Ω–Ω–∞—è" },
                        { id: 4, text: "d) –ü–æ–ª—É—Å—É—Ö–æ–∂–∏–ª—å–Ω–∞—è", correct: true }
                    ]
                },
                {
                    id: 3,
                    text: "3. –ö–∞–∫–∞—è –∏–∑ —ç—Ç–∏—Ö –º—ã—à—Ü –ù–ï –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –º—ã—à—Ü–∞–º –∫–æ—Ä–∞?",
                    options: [
                        { id: 1, text: "a) –ü—Ä—è–º–∞—è –º—ã—à—Ü–∞ –∂–∏–≤–æ—Ç–∞" },
                        { id: 2, text: "b) –ö–æ—Å—ã–µ –º—ã—à—Ü—ã –∂–∏–≤–æ—Ç–∞" },
                        { id: 3, text: "c) –¢—Ä–∞–ø–µ—Ü–∏—è", correct: true },
                        { id: 4, text: "d) –ü–æ–ø–µ—Ä–µ—á–Ω–∞—è –º—ã—à—Ü–∞ –∂–∏–≤–æ—Ç–∞" }
                    ]
                },
                {
                    id: 4,
                    text: "4. –ö–∞–∫–æ–µ –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ç—Ä–µ–Ω–∏—Ä—É–µ—Ç –∫–≤–∞–¥—Ä–∏—Ü–µ–ø—Å—ã?",
                    options: [
                        { id: 1, text: "a) –°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞" },
                        { id: 2, text: "b) –ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è", correct: true },
                        { id: 3, text: "c) –ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è" },
                        { id: 4, text: "d) –ñ–∏–º –Ω–æ–≥–∞–º–∏" }
                    ]
                },
                {
                    id: 5,
                    text: "5. –ö–∞–∫–∞—è –º—ã—à—Ü–∞ —è–≤–ª—è–µ—Ç—Å—è –≥–ª–∞–≤–Ω–æ–π –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∂–∏–º–∞ –≥–∞–Ω—Ç–µ–ª–µ–π –ª–µ–∂–∞?",
                    options: [
                        { id: 1, text: "a) –ë–∏—Ü–µ–ø—Å" },
                        { id: 2, text: "b) –ë–æ–ª—å—à–∞—è –≥—Ä—É–¥–Ω–∞—è –º—ã—à—Ü–∞", correct: true },
                        { id: 3, text: "c) –¢—Ä–∏—Ü–µ–ø—Å" },
                        { id: 4, text: "d) –î–µ–ª—å—Ç–æ–≤–∏–¥–Ω–∞—è –º—ã—à—Ü–∞" }
                    ]
                },
                {
                    id: 6,
                    text: "6. –ö–∞–∫–æ–π –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Ç–æ–¥–æ–≤ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –º—ã—à–µ—á–Ω—É—é –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å?",
                    options: [
                        { id: 1, text: "a) –ü–æ–≤—ã—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π —Å —É–º–µ–Ω—å—à–µ–Ω–∏–µ–º –≤–µ—Å–∞", correct: true },
                        { id: 2, text: "b) –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–¥—ã—Ö–∞ –º–µ–∂–¥—É –ø–æ–¥—Ö–æ–¥–∞–º–∏" },
                        { id: 3, text: "c) –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤–µ—Å–∞ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π" },
                        { id: 4, text: "d) –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö —Ä–µ–∑–∏–Ω–æ–∫" }
                    ]
                },
                {
                    id: 7,
                    text: "7. –°–∫–æ–ª—å–∫–æ —Å–ª–æ–µ–≤ –º—ã—à—Ü '—Ç–∞–∑–æ–≤–æ–≥–æ –¥–Ω–∞'?",
                    options: [
                        { id: 1, text: "–∞) 3" },
                        { id: 2, text: "–±) 5" },
                        { id: 3, text: "–≤) 6", correct: true }
                    ]
                },
                {
                    id: 8,
                    text: "8. –°–≥–∏–±–∞–Ω–∏–µ –≥–æ–ª–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç:",
                    options: [
                        { id: 1, text: "–∞) –ø–æ–ª—É—Å—É—Ö–æ–∂–∏–ª—å–Ω–∞—è", correct: true },
                        { id: 2, text: "–±) —á–µ—Ç—ã—Ä—ë—Ö–≥–ª–∞–≤–∞—è" },
                        { id: 3, text: "–≤) –≥—Ä—É—à–µ–≤–∏–¥–Ω–∞—è" },
                        { id: 4, text: "–≥) —Ä–æ–º–±–æ–≤–∏–¥–Ω–∞—è" }
                    ]
                },
                {
                    id: 9,
                    text: "9. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –ø—Ä–∏—Å–µ–¥–∞–Ω–∏–π —Å —É–ø–æ—Ä–æ–º –Ω–∞ —è–≥–æ–¥–∏—Ü—ã:",
                    options: [
                        { id: 1, text: "–∞) –Ω–æ–≥–∏ –Ω–∞ —à–∏—Ä–∏–Ω–µ –ø–ª–µ—á, —Ç–∞–∑ —Å–≥–∏–±–∞–µ–º –¥–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏ —Å –ø–æ–ª–æ–º, –∫–æ—Ä–ø—É—Å —Ä–æ–≤–Ω–æ, –æ–ø–æ—Ä–∞ –Ω–∞ –ø—è—Ç–∫—É, –≤—ã–¥–æ—Ö –Ω–∞–≤–µ—Ä—Ö" },
                        { id: 2, text: "–±) –Ω–æ–≥–∏ —à–∏—Ä–µ —à–∏—Ä–∏–Ω—ã –ø–ª–µ—á, —Ç–∞–∑ –æ–ø—É—Å–∫–∞–µ–º –≤—ã—à–µ –ø–∞—Ä–∞–ª–ª–µ–ª–∏ —Å –ø–æ–ª–æ–º, –æ–ø–æ—Ä–∞ –Ω–∞ –≤—Å—é —Å—Ç–æ–ø—É, –∫–æ—Ä–ø—É—Å –Ω–∞–∫–ª–æ–Ω—è–µ–º –≤–ø–µ—Ä–µ–¥ –Ω–∞ 50¬∞, –≤—ã–¥–æ—Ö –Ω–∞ —Å–≥–∏–±–∞–Ω–∏–∏" },
                        { id: 3, text: "–≤) –Ω–æ–≥–∏ —à–∏—Ä–µ —à–∏—Ä–∏–Ω—ã –ø–ª–µ—á, —Ç–∞–∑ –≤—ã—à–µ –ø–∞—Ä–∞–ª–ª–µ–ª–∏ —Å –ø–æ–ª–æ–º, –æ–ø–æ—Ä–∞ –Ω–∞ –≤—Å—é —Å—Ç–æ–ø—É, –∫–æ—Ä–ø—É—Å –≤ –Ω–∞–∫–ª–æ–Ω –≤–ø–µ—Ä–µ–¥ 45-50¬∞, –≤—ã–¥–æ—Ö –Ω–∞–≤–µ—Ä—Ö", correct: true }
                    ]
                },
                {
                    id: 10,
                    text: "10. –û—Ç–≤–µ–¥–µ–Ω–∏–µ –±–µ–¥—Ä–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç:",
                    options: [
                        { id: 1, text: "–∞) –ø–æ–ø–µ—Ä–µ—á–Ω–∞—è –º—ã—à—Ü–∞" },
                        { id: 2, text: "–±) –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞—è" },
                        { id: 3, text: "–≤) —Å—Ä–µ–¥–Ω—è—è —è–≥–æ–¥–∏—á–Ω–∞—è", correct: true },
                        { id: 4, text: "–≥) —Ç–æ–Ω–Ω–∞—è –ø—Ä–∏–≤–æ–¥—è—â–∞—è" }
                    ]
                },
                {
                    id: 11,
                    text: "11. –í –∫–∞–∫–æ–π –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –≤—ã–ø–∞–¥—ã?",
                    options: [
                        { id: 1, text: "–∞) —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è" },
                        { id: 2, text: "–±) —Å–∞–≥–∏—Ç—Ç–∞–ª—å–Ω–∞—è", correct: true },
                        { id: 3, text: "–≤) –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è" }
                    ]
                },
                {
                    id: 12,
                    text: "12. –ö–∞–∫–∏–µ –±–∞–∑–æ–≤—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≤—ã –∑–Ω–∞–µ—Ç–µ? (–Ω–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ–π –æ—Ç–≤–µ—Ç)",
                    options: [
                        { id: 1, text: "–∞) –û—Ç–≤–µ—Ç –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –≤—Ä—É—á–Ω—É—é" },
                        { id: 2, text: "–±) –ù–∞–ø–∏—à–∏—Ç–µ –æ—Ç–≤–µ—Ç –≤ –ø–æ–ª–µ –Ω–∏–∂–µ" },
                        { id: 3, text: "–≤) –≠—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å —Ç—Ä–µ–±—É–µ—Ç –ø–∏—Å—å–º–µ–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞" }
                    ],
                    customAnswer: true
                }
            ]
        };

        // –ö–ª—é—á–∏ –¥–ª—è localStorage
        const STORAGE_KEYS = {
            RESULTS: 'fitness_test_results',
            VIOLATIONS: 'fitness_test_violations',
            STATE: 'fitness_test_state'
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const state = {
            currentPage: 'home',
            userId: '',
            currentQuestion: 0,
            userAnswers: {},
            customAnswers: {},
            startTime: null,
            endTime: null,
            timeLeft: testData.timeLimit,
            timerInterval: null,
            violations: 0,
            isAdmin: false
        };

        // –≠–ª–µ–º–µ–Ω—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü
        const homePage = document.getElementById('home-page');
        const testPage = document.getElementById('test-page');
        const resultsPage = document.getElementById('results-page');
        const loginPage = document.getElementById('login-page');
        const adminPage = document.getElementById('admin-page');
        const warningModal = document.getElementById('warning-modal');

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è
            document.getElementById('nav-home').addEventListener('click', function(e) {
                e.preventDefault();
                showHomePage();
            });
            document.getElementById('nav-admin').addEventListener('click', function(e) {
                e.preventDefault();
                showAdminPage();
            });
            document.getElementById('nav-login').addEventListener('click', function(e) {
                e.preventDefault();
                showLoginPage();
            });
            
            // –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
            document.getElementById('start-test').addEventListener('click', startTest);
            
            // –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–µ—Å—Ç–∞
            document.getElementById('prev-question').addEventListener('click', prevQuestion);
            document.getElementById('next-question').addEventListener('click', nextQuestion);
            document.getElementById('finish-test').addEventListener('click', finishTest);
            
            // –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            document.getElementById('back-to-home').addEventListener('click', showHomePage);
            
            // –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞
            document.getElementById('admin-login-btn').addEventListener('click', adminLogin);
            
            // –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
            document.getElementById('admin-logout').addEventListener('click', adminLogout);
            document.getElementById('refresh-results').addEventListener('click', renderAdminPanel);
            document.getElementById('export-results').addEventListener('click', exportToCSV);
            document.getElementById('clear-results').addEventListener('click', clearAllResults);
            
            // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            document.getElementById('warning-ok').addEventListener('click', hideWarning);
            
            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ —Ñ–æ–∫—É—Å–∞
            document.addEventListener('visibilitychange', handleVisibilityChange);
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage
            loadFromLocalStorage();
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            showHomePage();
        });

        // –§—É–Ω–∫—Ü–∏–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function showHomePage() {
            hideAllPages();
            homePage.classList.remove('hidden');
            state.currentPage = 'home';
        }

        function showTestPage() {
            hideAllPages();
            testPage.classList.remove('hidden');
            state.currentPage = 'test';
            renderQuestion();
            updateProgress();
            startTimer();
        }

        function showResultsPage() {
            hideAllPages();
            resultsPage.classList.remove('hidden');
            state.currentPage = 'results';
            displayResults();
        }

        function showLoginPage() {
            hideAllPages();
            loginPage.classList.remove('hidden');
            state.currentPage = 'login';
        }

        function showAdminPage() {
            if (!state.isAdmin) {
                showLoginPage();
                return;
            }
            hideAllPages();
            adminPage.classList.remove('hidden');
            state.currentPage = 'admin';
            renderAdminPanel();
        }

        function hideAllPages() {
            homePage.classList.add('hidden');
            testPage.classList.add('hidden');
            resultsPage.classList.add('hidden');
            loginPage.classList.add('hidden');
            adminPage.classList.add('hidden');
        }

        function hideWarning() {
            warningModal.classList.add('hidden');
        }

        // –§—É–Ω–∫—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function startTest() {
            const userId = document.getElementById('user-id').value.trim();
            if (!userId) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä');
                return;
            }
            
            state.userId = userId;
            state.currentQuestion = 0;
            state.userAnswers = {};
            state.customAnswers = {};
            state.startTime = new Date();
            state.timeLeft = testData.timeLimit;
            state.violations = 0;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            saveToLocalStorage();
            
            showTestPage();
        }

        function renderQuestion() {
            const questionContainer = document.getElementById('question-container');
            const question = testData.questions[state.currentQuestion];
            
            let html = `
                <div class="question">
                    <h3>‚ùì –í–æ–ø—Ä–æ—Å ${state.currentQuestion + 1} –∏–∑ ${testData.questions.length}</h3>
                    <p>${question.text}</p>
            `;
            
            if (question.customAnswer) {
                // –î–ª—è –≤–æ–ø—Ä–æ—Å–∞ —Å –ø–∏—Å—å–º–µ–Ω–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º
                html += `
                    <div class="form-group">
                        <label for="custom-answer">–í–∞—à –æ—Ç–≤–µ—Ç:</label>
                        <textarea id="custom-answer" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ –±–∞–∑–æ–≤—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∑–¥–µ—Å—å...">${state.customAnswers[question.id] || ''}</textarea>
                    </div>
                `;
            } else {
                // –î–ª—è –æ–±—ã—á–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏
                html += `<div class="options">`;
                
                question.options.forEach(option => {
                    const isSelected = state.userAnswers[question.id] === option.id;
                    html += `
                        <div class="option ${isSelected ? 'selected' : ''}" data-question="${question.id}" data-option="${option.id}">
                            ${option.text}
                        </div>
                    `;
                });
                
                html += `</div>`;
            }
            
            html += `</div>`;
            
            questionContainer.innerHTML = html;
            
            if (!question.customAnswer) {
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
                document.querySelectorAll('.option').forEach(option => {
                    option.addEventListener('click', function() {
                        const questionId = parseInt(this.getAttribute('data-question'));
                        const optionId = parseInt(this.getAttribute('data-option'));
                        
                        // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
                        document.querySelectorAll(`.option[data-question="${questionId}"]`).forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        
                        // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π
                        this.classList.add('selected');
                        
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç–≤–µ—Ç
                        state.userAnswers[questionId] = optionId;
                        saveToLocalStorage();
                    });
                });
            } else {
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è
                const textarea = document.getElementById('custom-answer');
                textarea.addEventListener('input', function() {
                    state.customAnswers[question.id] = this.value;
                    saveToLocalStorage();
                });
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            document.getElementById('prev-question').disabled = state.currentQuestion === 0;
            document.getElementById('next-question').disabled = state.currentQuestion === testData.questions.length - 1;
        }

        function prevQuestion() {
            if (state.currentQuestion > 0) {
                state.currentQuestion--;
                renderQuestion();
                updateProgress();
            }
        }

        function nextQuestion() {
            if (state.currentQuestion < testData.questions.length - 1) {
                state.currentQuestion++;
                renderQuestion();
                updateProgress();
            }
        }

        function updateProgress() {
            const progress = document.getElementById('progress');
            const percentage = ((state.currentQuestion + 1) / testData.questions.length) * 100;
            progress.style.width = `${percentage}%`;
        }

        function startTimer() {
            updateTimerDisplay();
            
            if (state.timerInterval) {
                clearInterval(state.timerInterval);
            }
            
            state.timerInterval = setInterval(function() {
                state.timeLeft--;
                updateTimerDisplay();
                
                if (state.timeLeft <= 0) {
                    finishTest();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(state.timeLeft / 60);
            const seconds = state.timeLeft % 60;
            document.getElementById('timer').textContent = `‚è±Ô∏è –û—Å—Ç–∞–ª–æ—Å—å: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function finishTest() {
            state.endTime = new Date();
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
            if (state.timerInterval) {
                clearInterval(state.timerInterval);
                state.timerInterval = null;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            saveResults();
            
            // –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–µ—Å—Ç–∞
            clearTestState();
            
            showResultsPage();
        }

        function displayResults() {
            // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã (–∫—Ä–æ–º–µ –≤–æ–ø—Ä–æ—Å–∞ —Å –ø–∏—Å—å–º–µ–Ω–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º)
            let correctAnswers = 0;
            testData.questions.forEach(question => {
                if (!question.customAnswer) {
                    const userAnswer = state.userAnswers[question.id];
                    if (userAnswer) {
                        const selectedOption = question.options.find(opt => opt.id === userAnswer);
                        if (selectedOption && selectedOption.correct) {
                            correctAnswers++;
                        }
                    }
                }
            });
            
            // –í—ã—á–∏—Å–ª—è–µ–º –≤—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
            const timeSpent = Math.floor((state.endTime - state.startTime) / 1000);
            const minutes = Math.floor(timeSpent / 60);
            const seconds = timeSpent % 60;
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            document.getElementById('score-result').innerHTML = `
                <p>‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: <strong>${correctAnswers} –∏–∑ ${testData.questions.length - 1}</strong></p>
                <p>üìä –ü—Ä–æ—Ü–µ–Ω—Ç: <strong>${Math.round((correctAnswers / (testData.questions.length - 1)) * 100)}%</strong></p>
                <p>‚úçÔ∏è –í–æ–ø—Ä–æ—Å 12 –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω –æ—Ç–¥–µ–ª—å–Ω–æ</p>
            `;
            
            document.getElementById('time-result').innerHTML = `
                <p>‚è±Ô∏è –í—Ä–µ–º—è: <strong>${minutes} –º–∏–Ω. ${seconds} —Å–µ–∫.</strong></p>
            `;
            
            document.getElementById('violations-result').innerHTML = `
                <p>üö´ –ù–∞—Ä—É—à–µ–Ω–∏–π: <strong>${state.violations}</strong></p>
            `;
        }

        // –§—É–Ω–∫—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        function handleVisibilityChange() {
            if (state.currentPage === 'test' && document.hidden) {
                state.violations++;
                saveToLocalStorage();
                warningModal.classList.remove('hidden');
                
                // –ï—Å–ª–∏ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –Ω–∞—Ä—É—à–µ–Ω–∏–π, –∑–∞–≤–µ—Ä—à–∞–µ–º —Ç–µ—Å—Ç
                if (state.violations >= 3) {
                    finishTest();
                }
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        function adminLogin() {
            const login = document.getElementById('admin-login').value;
            const password = document.getElementById('admin-password').value;
            
            // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
            if (login === 'admin' && password === 'admin123') {
                state.isAdmin = true;
                document.getElementById('nav-admin').classList.remove('hidden');
                showAdminPage();
            } else {
                alert('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å');
            }
        }

        function adminLogout() {
            state.isAdmin = false;
            document.getElementById('nav-admin').classList.add('hidden');
            showHomePage();
        }

        function renderAdminPanel() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ localStorage
            const results = getAllResults();
            const violations = getAllViolations();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            document.getElementById('total-results').textContent = results.length;
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            const resultsTable = document.getElementById('results-table').querySelector('tbody');
            resultsTable.innerHTML = '';
            
            if (results.length === 0) {
                resultsTable.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px;">–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</td></tr>';
            } else {
                results.forEach(result => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${result.userId}</td>
                        <td>${new Date(result.timestamp).toLocaleString()}</td>
                        <td>${result.correctAnswers}</td>
                        <td>${result.totalQuestions}</td>
                        <td>${Math.floor(result.timeSpent / 60)}:${(result.timeSpent % 60).toString().padStart(2, '0')}</td>
                        <td>${result.violations}</td>
                        <td>${result.customAnswer ? result.customAnswer.substring(0, 50) + (result.customAnswer.length > 50 ? '...' : '') : '-'}</td>
                    `;
                    resultsTable.appendChild(row);
                });
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –Ω–∞—Ä—É—à–µ–Ω–∏—è
            const violationsTable = document.getElementById('violations-table').querySelector('tbody');
            violationsTable.innerHTML = '';
            
            if (violations.length === 0) {
                violationsTable.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 20px;">–ù–µ—Ç –Ω–∞—Ä—É—à–µ–Ω–∏–π</td></tr>';
            } else {
                violations.forEach(violation => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${violation.userId}</td>
                        <td>${new Date(violation.timestamp).toLocaleString()}</td>
                        <td>${violation.type}</td>
                        <td>${violation.info || ''}</td>
                    `;
                    violationsTable.appendChild(row);
                });
            }
        }

        function exportToCSV() {
            const results = getAllResults();
            if (results.length === 0) {
                alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞');
                return;
            }

            let csv = 'ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è,–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã,–í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤,–í—Ä–µ–º—è (—Å–µ–∫),–ù–∞—Ä—É—à–µ–Ω–∏—è,–û—Ç–≤–µ—Ç –Ω–∞ 12 –≤–æ–ø—Ä–æ—Å\n';
            
            results.forEach(result => {
                const row = [
                    `"${result.userId}"`,
                    `"${new Date(result.timestamp).toLocaleString()}"`,
                    result.correctAnswers,
                    result.totalQuestions,
                    result.timeSpent,
                    result.violations,
                    `"${(result.customAnswer || '').replace(/"/g, '""')}"`
                ];
                csv += row.join(',') + '\n';
            });

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã_—Ç–µ—Å—Ç–∞_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function clearAllResults() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –í–°–ï —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                localStorage.removeItem(STORAGE_KEYS.RESULTS);
                localStorage.removeItem(STORAGE_KEYS.VIOLATIONS);
                renderAdminPanel();
                alert('–í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —É–¥–∞–ª–µ–Ω—ã');
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å localStorage
        function saveToLocalStorage() {
            localStorage.setItem(STORAGE_KEYS.STATE, JSON.stringify({
                userId: state.userId,
                currentQuestion: state.currentQuestion,
                userAnswers: state.userAnswers,
                customAnswers: state.customAnswers,
                startTime: state.startTime,
                timeLeft: state.timeLeft,
                violations: state.violations
            }));
        }

        function loadFromLocalStorage() {
            const savedState = localStorage.getItem(STORAGE_KEYS.STATE);
            if (savedState) {
                const stateData = JSON.parse(savedState);
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –µ—Å–ª–∏ —Ç–µ—Å—Ç –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω
                if (stateData.userId && stateData.startTime) {
                    state.userId = stateData.userId;
                    state.currentQuestion = stateData.currentQuestion;
                    state.userAnswers = stateData.userAnswers;
                    state.customAnswers = stateData.customAnswers || {};
                    state.startTime = new Date(stateData.startTime);
                    state.timeLeft = stateData.timeLeft;
                    state.violations = stateData.violations;
                    
                    // –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ç–µ—Å—Ç
                    if (state.currentPage === 'home') {
                        const continueTest = confirm('–û–±–Ω–∞—Ä—É–∂–µ–Ω –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç. –•–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å?');
                        if (continueTest) {
                            showTestPage();
                        }
                    }
                }
            }
        }

        function saveResults() {
            // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã (–∫—Ä–æ–º–µ –≤–æ–ø—Ä–æ—Å–∞ —Å –ø–∏—Å—å–º–µ–Ω–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º)
            let correctAnswers = 0;
            testData.questions.forEach(question => {
                if (!question.customAnswer) {
                    const userAnswer = state.userAnswers[question.id];
                    if (userAnswer) {
                        const selectedOption = question.options.find(opt => opt.id === userAnswer);
                        if (selectedOption && selectedOption.correct) {
                            correctAnswers++;
                        }
                    }
                }
            });
            
            // –í—ã—á–∏—Å–ª—è–µ–º –≤—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
            const timeSpent = Math.floor((state.endTime - state.startTime) / 1000);
            
            const result = {
                userId: state.userId,
                timestamp: state.endTime,
                correctAnswers: correctAnswers,
                totalQuestions: testData.questions.length - 1, // –º–∏–Ω—É—Å –≤–æ–ø—Ä–æ—Å —Å –ø–∏—Å—å–º–µ–Ω–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º
                timeSpent: timeSpent,
                violations: state.violations,
                customAnswer: state.customAnswers[12] || ''
            };

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            const results = getAllResults();
            results.push(result);
            localStorage.setItem(STORAGE_KEYS.RESULTS, JSON.stringify(results));
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Ä—É—à–µ–Ω–∏—è
            if (state.violations > 0) {
                const violations = getAllViolations();
                violations.push({
                    userId: state.userId,
                    timestamp: state.endTime,
                    type: '–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫',
                    info: `–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ ${state.violations} –Ω–∞—Ä—É—à–µ–Ω–∏–π`
                });
                localStorage.setItem(STORAGE_KEYS.VIOLATIONS, JSON.stringify(violations));
            }
        }

        function getAllResults() {
            return JSON.parse(localStorage.getItem(STORAGE_KEYS.RESULTS) || '[]');
        }

        function getAllViolations() {
            return JSON.parse(localStorage.getItem(STORAGE_KEYS.VIOLATIONS) || '[]');
        }

        function clearTestState() {
            localStorage.removeItem(STORAGE_KEYS.STATE);
        }
    </script>
</body>
</html>